<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./CSS_files/update_leaflet.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

  <title>Update a leaflet</title>

</head>

<body>

  <h1>Update a sub Product</h1>
  <form id="leafletForm">
    <label for="leafletId" style="display: none;">Country ID:</label>
    <input type="text" id="leafletId" name="leafletId" style="display: none;" required>
    <!-- Product Information -->
    <div class="form-group">
      <label for="leafletProductName">Product Name:</label>
      <input type="text" id="leafletProductName" name="leafletProductName" required>
    </div>
  
    <div class="form-group">
      <label for="leafletSubProductName">Leaflet Name (AR):</label>
      <input type="text" id="leafletSubProductName" name="leafletSubProductName" required>
    </div>
  
    <!-- Country Input -->
    <div class="form-group">
      <label for="country">Country:</label>
      <input type="text" id="country" name="country" required>
    </div>
  
    <!-- Leaflet Pages -->
    <div class="form-group">
      <label for="leafletPages">Leaflet Pages:</label>
      <div class="leaflet-pages">
        <!-- Pages 1 to 6 -->
        <input type="file" id="leafletPage1" name="leafletPage1" accept="image/*" required onchange="previewImage(this);">
        <img id="leafletPage1Preview" src="" alt="Selected Image" style="max-width: 100%; display: none;">
  
        <label for="leafletPage2">leaflet Page2</label>
    <input type="file" id="leafletPage2" name="leafletPage2" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage2Preview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">
    

    <label for="leafletPage3">leaflet Page3</label>
    <input type="file" id="leafletPage3" name="leafletPage3" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage3Preview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage4">leaflet Page4</label>
    <input type="file" id="leafletPage4" name="leafletPage4" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage4Preview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage5">leaflet Page5</label>
    <input type="file" id="leafletPage5" name="leafletPage5" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage5Preview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage6">leaflet Page6</label>
    <input type="file" id="leafletPage6" name="leafletPage6" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage6Preview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">
  
      </div>
    </div>
  
    <!-- Leaflet Pages (AR) -->
    <div class="form-group">
      <label for="leafletPagesAR">Leaflet Pages (AR):</label>
      <div class="leaflet-pages-ar">
        <!-- Pages 1AR to 6AR -->
        
        <label for="leafletPage1AR">leaflet Page2AR</label>
    <input type="file" id="leafletPage1AR" name="leafletPage1AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage1ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

        <label for="leafletPage2AR">leaflet Page2AR</label>
    <input type="file" id="leafletPage2AR" name="leafletPage2AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage2ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage3AR">leaflet Page3AR</label>
    <input type="file" id="leafletPage3AR" name="leafletPage3AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage3ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage4AR">leaflet Page4AR</label>
    <input type="file" id="leafletPage4AR" name="leafletPage4AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage4ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage5AR">leaflet Page5AR</label>
    <input type="file" id="leafletPage5AR" name="leafletPage5AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage5ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">

    <label for="leafletPage6AR">leaflet Page6AR</label>
    <input type="file" id="leafletPage6AR" name="leafletPage6AR" accept="image/*" required onchange="previewImage(this);">
    <img id="leafletPage6ARPreview" src="#" alt="Selected Image" style="max-width: 100%; display: none;">
  
        
      </div>
    </div>


    <div class="d-grid gap-2" id="form-button">
      <button id="updateButton" class="btn btn-success" type="button" onclick="updateleaflet(document.getElementById('leafletId').value)">Update</button>
      <button id="closeButton" class="btn btn-danger" type="button" onclick="closeForm()">Close</button>
    </div>
  </form>






  <script>


  async function updateleaflet(leafletId) {
    try {
        // Fetch the existing data for the leaflet
        const response = await fetch(`https://arabbank.azurewebsites.net/api/leaflet/${leafletId}`);
        const existingData = await response.json();

        // Update data with form values
        const updatedData = {
            id: leafletId,
            product: document.getElementById("leafletProductName").value,
            subProduct: document.getElementById("leafletSubProductName").value,
            country: document.getElementById("country").value,
            leafletPage1: document.getElementById("leafletPage1").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage1").getAttribute('data-base64') : existingData.leafletPage1,
            leafletPage2: document.getElementById("leafletPage2").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage2").getAttribute('data-base64') : existingData.leafletPage2,
            leafletPage3: document.getElementById("leafletPage3").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage3").getAttribute('data-base64') : existingData.leafletPage3,
            leafletPage4: document.getElementById("leafletPage4").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage4").getAttribute('data-base64') : existingData.leafletPage4,
            leafletPage5: document.getElementById("leafletPage5").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage5").getAttribute('data-base64') : existingData.leafletPage5,
            leafletPage6: document.getElementById("leafletPage6").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage6").getAttribute('data-base64') : existingData.leafletPage6,
            // Add similar lines for leaflet pages 2 to 6
            leafletPage1AR: document.getElementById("leafletPage1AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage1AR").getAttribute('data-base64') : existingData.leafletPage1AR,
            leafletPage2AR: document.getElementById("leafletPage2AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage2AR").getAttribute('data-base64') : existingData.leafletPage2AR,
            leafletPage3AR: document.getElementById("leafletPage3AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage3AR").getAttribute('data-base64') : existingData.leafletPage3AR,
            leafletPage4AR: document.getElementById("leafletPage4AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage4AR").getAttribute('data-base64') : existingData.leafletPage4AR,
            leafletPage5AR: document.getElementById("leafletPage5AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage5AR").getAttribute('data-base64') : existingData.leafletPage5AR,
            leafletPage6AR: document.getElementById("leafletPage6AR").getAttribute('data-base64') ? "data:image/png;base64," + document.getElementById("leafletPage6AR").getAttribute('data-base64') : existingData.leafletPage6AR,
            // ... add more fields if needed

            // Add similar lines for leaflet pages AR 2 to 6
            // ... add more fields if needed
        };

        // Make a PUT request to update the leaflet
        const putResponse = await fetch(`https://arabbank.azurewebsites.net/api/leaflet/${leafletId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(updatedData),
        });
        const leafletPage1ARBase64 = document.getElementById("leafletPage1AR").getAttribute('data-base64');
            console.log('leafletPage1ARBase64:', leafletPage1ARBase64);

        if (putResponse.ok) {
            console.log('Leaflet updated successfully.');
            // Close the form
            closeForm();
        } else {
            console.error('Failed to update leaflet.');
        }
    } catch (error) {
        console.error('Error updating leaflet:', error);
    }
}

    



  </script>






  <script src="./JS_files/update_leaflet.js" defer></script>
  <!-- <script src="../leaflet/CSS_files/update_leaflet.css"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
</body>

</html>
